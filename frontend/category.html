<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Category — LUXE STANDARD</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Tenor+Sans&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --black: #0a0a0a; --charcoal: #1a1a1a; --graphite: #2d2d2d;
      --slate: #4a4a4a; --mist: #9a9a9a; --silver: #c8c8c8;
      --ivory: #f5f0e8; --cream: #faf7f2; --white: #ffffff;
      --gold: #c9a84c;
      --font-display: 'Cormorant Garamond', Georgia, serif;
      --font-ui: 'Tenor Sans', sans-serif;
      --font-body: 'DM Sans', sans-serif;
      --max-width: 1400px; --gutter: clamp(1.5rem, 4vw, 4rem);
      --transition: 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    }
    html { scroll-behavior: smooth; }
    body { background: var(--cream); color: var(--charcoal); font-family: var(--font-body); -webkit-font-smoothing: antialiased; }
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-thumb { background: var(--gold); }

    .nav {
      position: fixed; top: 0; left: 0; right: 0; z-index: 100;
      padding: 0 var(--gutter); height: 64px;
      display: flex; align-items: center; justify-content: space-between;
      background: rgba(250,247,242,0.9); backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(201,168,76,0.12);
    }
    .nav-logo { font-family: var(--font-ui); font-size: 1rem; letter-spacing: 0.25em; color: var(--black); text-decoration: none; }
    .nav-back { font-family: var(--font-body); font-size: 0.75rem; font-weight: 500; letter-spacing: 0.1em; text-transform: uppercase; color: var(--slate); text-decoration: none; transition: color var(--transition); }
    .nav-back:hover { color: var(--gold); }

    .category-hero {
      padding-top: 64px; background: var(--black); color: var(--white);
      min-height: 35vh; display: flex; align-items: flex-end;
    }
    .category-hero-content {
      max-width: var(--max-width); margin: 0 auto; width: 100%;
      padding: 4rem var(--gutter);
    }
    .category-hero-icon { font-size: 2rem; margin-bottom: 1rem; }
    .category-hero-name {
      font-family: var(--font-display); font-size: clamp(2rem, 5vw, 4rem);
      font-weight: 300; color: var(--white); margin-bottom: 0.75rem;
    }
    .category-hero-desc { font-size: 1rem; color: rgba(255,255,255,0.5); max-width: 50ch; line-height: 1.7; }

    .section { max-width: var(--max-width); margin: 0 auto; padding: clamp(3rem, 6vh, 5rem) var(--gutter); }

    .article-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 2.5rem; }
    .article-card { cursor: pointer; text-decoration: none; color: inherit; display: block; transition: transform var(--transition); }
    .article-card:hover { transform: translateY(-4px); }
    .card-image { aspect-ratio: 3/2; background: var(--charcoal); overflow: hidden; margin-bottom: 1.25rem; }
    .card-image img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.6s ease; filter: grayscale(15%); }
    .article-card:hover .card-image img { transform: scale(1.04); filter: grayscale(0%); }
    .card-placeholder { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; opacity: 0.2; }
    .card-category { font-size: 0.68rem; font-weight: 500; letter-spacing: 0.2em; text-transform: uppercase; color: var(--gold); margin-bottom: 0.5rem; }
    .card-title { font-family: var(--font-display); font-size: 1.4rem; font-weight: 400; line-height: 1.3; color: var(--black); margin-bottom: 0.75rem; }
    .card-excerpt { font-size: 0.88rem; color: var(--slate); line-height: 1.7; margin-bottom: 1rem; }
    .card-meta { display: flex; align-items: center; gap: 1rem; font-size: 0.72rem; color: var(--mist); }
    .card-type-badge { background: var(--graphite); color: var(--silver); padding: 0.2rem 0.6rem; font-size: 0.65rem; letter-spacing: 0.1em; text-transform: uppercase; border-radius: 2px; }

    .load-more {
      display: block; margin: 3rem auto 0; background: none; border: 1px solid var(--black);
      color: var(--black); font-family: var(--font-body); font-size: 0.78rem; font-weight: 500;
      letter-spacing: 0.15em; text-transform: uppercase; padding: 1rem 3rem; cursor: pointer;
      transition: all var(--transition);
    }
    .load-more:hover { background: var(--black); color: var(--white); }

    @media (max-width: 768px) { .article-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <nav class="nav">
    <a href="/" class="nav-logo">LUXE STANDARD</a>
    <a href="/" class="nav-back">← Home</a>
  </nav>

  <header class="category-hero" id="cat-hero">
    <div class="category-hero-content">
      <div class="category-hero-icon" id="cat-icon">◆</div>
      <h1 class="category-hero-name" id="cat-name">Loading…</h1>
      <p class="category-hero-desc" id="cat-desc"></p>
    </div>
  </header>

  <section class="section">
    <div class="article-grid" id="article-grid"></div>
    <button class="load-more" id="load-more" style="display:none">Load More</button>
  </section>

  <footer style="background:var(--black);color:rgba(255,255,255,.3);padding:1.5rem var(--gutter);text-align:center;font-size:.75rem">
    <a href="/" style="color:var(--gold);text-decoration:none">← Back to LUXE STANDARD</a>
  </footer>

  <script type="module">
    const API = '/api';
    const slug = window.location.pathname.split('/').filter(Boolean).pop();

    let page = 1;
    const limit = 12;
    let totalPages = 1;

    const fmt = {
      type: t => ({ spotlight: 'Spotlight', comparison: 'Comparison', lifestyle: 'Lifestyle', guide: 'Guide' })[t] || t,
    };

    function renderCard(a) {
      const img = a.hero_image_url
        ? `<img src="${a.hero_image_url}" alt="${a.title}" loading="lazy">`
        : `<div class="card-placeholder">◆</div>`;
      return `
        <a href="/articles/${a.slug}" class="article-card">
          <div class="card-image">${img}</div>
          <div class="card-category">${a.category_name || ''}</div>
          <h2 class="card-title">${a.title}</h2>
          <p class="card-excerpt">${a.excerpt || ''}</p>
          <div class="card-meta">
            <span class="card-type-badge">${fmt.type(a.article_type)}</span>
            <span>${a.read_time_minutes} min read</span>
          </div>
        </a>`;
    }

    async function init() {
      // Load category info
      const cats = await fetch(`${API}/categories`).then(r => r.json()).catch(() => []);
      const cat = cats.find(c => c.slug === slug);
      if (cat) {
        document.title = `${cat.name} — LUXE STANDARD`;
        document.getElementById('cat-icon').textContent = cat.icon || '◆';
        document.getElementById('cat-name').textContent = cat.name;
        document.getElementById('cat-desc').textContent = cat.description || '';
      }
    }

    async function loadArticles() {
      const grid = document.getElementById('article-grid');
      const data = await fetch(`${API}/articles?category=${slug}&page=${page}&limit=${limit}`)
        .then(r => r.json()).catch(() => ({ articles: [], pagination: { pages: 1 } }));

      totalPages = data.pagination?.pages || 1;

      if (!data.articles?.length && page === 1) {
        grid.innerHTML = `<div style="grid-column:1/-1;padding:4rem;text-align:center;font-family:var(--font-display);font-size:1.25rem;font-style:italic;color:var(--mist)">No articles in this category yet.</div>`;
        return;
      }

      grid.insertAdjacentHTML('beforeend', data.articles.map(renderCard).join(''));
      document.getElementById('load-more').style.display = page < totalPages ? 'block' : 'none';
    }

    document.getElementById('load-more').addEventListener('click', () => {
      page++;
      loadArticles();
    });

    await init();
    await loadArticles();
  </script>
</body>
</html>
